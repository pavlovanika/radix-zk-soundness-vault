# radix-zk-soundness-vault

Minimal Scrypto blueprint for Radix that demonstrates a privacy inspired vault for XRD. The design is influenced by web3 projects working on zero knowledge and encrypted computation, such as Aztec, Zama, and soundness oriented proof systems.

The blueprint stores deposits as opaque notes keyed by a commitment string while keeping the on ledger logic focused on simple accounting and event emission. Real zk and FHE logic is intentionally left off chain.

Repository contains three main files:

  1. app.zk_scrypto.rs – Scrypto blueprint implementing the vault
  2. scripts.zk_scrypto.rs – example Scrypto scripts for instantiating and calling the vault
  3. README.md – this documentation file


---

## Concept

High level idea:

Users deposit XRD into a shared vault component.

Each deposit is associated with a commitment string that can represent a hash, encrypted blob, or identifier generated by a zk or FHE engine aligned with Aztec or Zama style flows.

Off chain logic is responsible for generating proofs that state transitions are sound. This includes proof of conservation of value and proof that the caller is allowed to spend a note.

On chain, the Scrypto blueprint:

Holds all deposited XRD in a single Vault.

Stores lightweight note metadata in a key value store.

Emits deposit and withdrawal events that can be consumed by indexers and relayers.

By keeping on chain logic simple and transparent, the system emphasizes soundness at the ledger level while delegating heavy cryptography to off chain services.

---

## Features

Single asset vault that only accepts XRD.

Deposit with commitment:

Accepts a Bucket of XRD plus a commitment string.

Mints a logical note identified by a numeric id.

Increases total_locked and stores a Note in a key value store.

Emits a DepositEvent for indexers.

Withdraw by note id:

Marks a stored note as spent.

Decreases total_locked.

Withdraws the recorded XRD amount from the internal Vault.

Emits a WithdrawalEvent.

Read only views for monitoring:

get_total_locked returns total XRD locked in the vault according to the internal accounting.

get_note_count returns how many notes have been created so far.

get_note_metadata returns the stored Note for a given note id, which includes the commitment, amount, and spent flag.

Minimal integration hooks for zk and FHE systems:

Commitment field meant to be created by circuits or encrypted computation pipelines similar to Aztec or Zama systems.

Events intended to be streamed into off chain proof generators and verifiers that uphold soundness properties.

---

## Repository structure

app.zk_scrypto.rs

Contains a single blueprint module named zk_soundness_vault.

Defines the core state struct ZkSoundnessVault with:

An internal Vault for XRD.

A KeyValueStore mapping note ids to Note structures.

A counter for the next note id.

A Decimal accumulator tracking total_locked.

Implements public blueprint methods for deployment and interaction.

README.md

The file you are reading now.

---

## Prerequisites

To build and run the blueprint you will need:

Radix Scrypto toolchain installed.

Access to a local or test environment for transaction submission, such as the Radix Babylon toolchain or Gateway and wallet tools.

Basic familiarity with Scrypto concepts:

Packages and blueprints.

Components, Vaults, and Buckets.

Transactions and manifests.

Assumptions:

You already have an account with test XRD.

You can build and publish Scrypto packages from the command line.

---

## Installation

Create a new folder for the project.

Example name: radix-zk-soundness-vault.

Initialize a Scrypto package in this folder using the standard Scrypto command that scaffolds a new package.

Delete the default blueprint file that is generated in the src directory.

Copy the app.zk_scrypto.rs file into the src directory of your Scrypto package.

In src, either rename app.zk_scrypto.rs to lib.rs or change your package configuration to compile this file as the main library file, depending on the Scrypto version and template you are using.

Ensure that the file app.zk_scrypto.rs contains the zk_soundness_vault blueprint exactly once and that there are no conflicting module names in other files.

---

## Building

From the root of your Scrypto package run the build command used for Scrypto packages.

The compilation should succeed provided that:

The Scrypto version matches the syntax of the blueprint.

The Radix tooling is correctly installed and configured.

No other files introduce name collisions with the zk_soundness_vault module or ZkSoundnessVault struct.

If compilation fails due to version differences, adjust imports and the globalize pattern in the instantiate function to match your Scrypto release while preserving the core struc

## Usage (Quickstart examples)

> Note: The exact commands / manifest syntax may differ slightly depending on your Scrypto / Babylon tooling version. Treat the snippets below as templates.

### 1. Instantiate the vault

- Build and publish your Scrypto package as usual.
- Then instantiate the `ZkSoundnessVault` blueprint using a transaction manifest similar to:

```text
# Pseudo-manifest (adjust for your tooling)
CALL_FUNCTION
  Address("PACKAGE_ADDRESS_HERE")
  "zk_soundness_vault"
  "instantiate_zk_soundness_vault"
  ;

